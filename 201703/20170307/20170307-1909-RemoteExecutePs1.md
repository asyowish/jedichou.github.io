### 20170302 - 远端执行PowerShell脚本

之前一直弄不明白PowerShell如何执行远程命令的！昨天和进勇一起进行了初步的探讨，以下给出简略步骤（假设A->B，即A要在B上执行命令）：

1. 分别在A、B两端进行WinRM的设置（执行winrm quickconfig）；
2. 在A上设置TrustHost，使A的信任列表里包含B；
3. 在B上设置WinRM服务，令其可以允许“可接受远程控制”；
4. 使用Invoke-Command执行远端命令；

有几个坑需要注意下：
* 以上实验要在域中执行，非域环境下似乎很麻烦，我和进勇没试过；
* 网络不要设置为“公共”，要设置成“私有”或“工作”；
* 建议PowerShell、WinRM的版本不要过低，估计一堆麻烦；

实验目的：验证PowerShell远端执行的方式，然后基础的运维可以通过脚本来执行。后续可以写一个PowerShell远端执行的中间件，用C#来调用。至于如何调用方式就很多了，WebService、WebAPI呀，多了去了！显然可以大幅度提高Windows运维自动化（这正是我习惯干滴）。
